---
- name: Install packages
  become: yes
  apt:
    update_cache: yes
    name:
      - chrome-gnome-shell
      - gnome-session
      - gnome-shell-extension-appindicator
      - gnome-tweaks
      - gnome-shell-pomodoro
      - nautilus

- name: Get gnome shell version
  shell: gnome-shell --version | sed 's/GNOME Shell //'
  register: r_gnome_shell_version
  changed_when: no

- name: Install extensions
  include_tasks: install_extension.yml
  vars:
    gnome_shell_version: "{{ r_gnome_shell_version.stdout }}"
    extension_id: "{{ item }}"
  with_items:
    - 307 # Dash to dock
    - 448 # Remove rounded corners
    - 1007 # Window Is Ready - Notification Remover
    - 1765 # Transparent top bar
    - 1144 # Shortcuts
    - 973 # Switcher
    - 19 # User themes
    - 1683 # Draw on your screen

- name: Configure gnome
  become: yes
  become_user: "{{ user }}"
  dconf:
    key: "{{ item.key }}"
    value: "{{ item.value | string }}"
  with_items:
    - key: "/org/gnome/desktop/calendar/show-weekdate"
      value: "true"
    - key: "/org/gnome/desktop/input-sources/mru-sources"
      value: "[('xkb', 'us'), ('xkb', 'at')]"
    - key: "/org/gnome/desktop/input-sources/sources"
      value: "[('xkb', 'us'), ('xkb', 'at')]"
    - key: "/org/gnome/desktop/input-sources/xkb-options"
      value: "['grp:shifts_toggle']"
    - key: "/org/gnome/desktop/interface/clock-show-weekday"
      value: "true"
    - key: "/org/gnome/desktop/interface/cursor-theme"
      value: "'Yaru'"
    - key: "/org/gnome/desktop/interface/document-font-name"
      value: "'Ubuntu 11'"
    - key: "/org/gnome/desktop/interface/enable-hot-corners"
      value: "false"
    - key: "/org/gnome/desktop/interface/font-name"
      value: "'Ubuntu 11'"
    - key: "/org/gnome/desktop/interface/gtk-theme"
      value: "'Yaru-dark'"
    - key: "/org/gnome/desktop/interface/icon-theme"
      value: "'Yaru'"
    - key: "/org/gnome/desktop/interface/monospace-font-name"
      value: "'Ubuntu Mono 11'"
    - key: "/org/gnome/desktop/privacy/report-technical-problems"
      value: "false"
    - key: "/org/gnome/desktop/search-providers/disabled"
      value: "['org.gnome.Software.desktop']"
    - key: "/org/gnome/desktop/wm/keybindings/cycle-windows-backward"
      value: "['<Shift><Alt>Escape']"
    - key: "/org/gnome/desktop/wm/keybindings/cycle-windows"
      value: "['<Alt>Escape']"
    - key: "/org/gnome/desktop/wm/keybindings/maximize"
      value: "['<Primary><Super>Up']"
    - key: "/org/gnome/desktop/wm/keybindings/minimize"
      value: "@as []"
    - key: "/org/gnome/desktop/wm/keybindings/move-to-monitor-down"
      value: "@as []"
    - key: "/org/gnome/desktop/wm/keybindings/move-to-monitor-up"
      value: "@as []"
    - key: "/org/gnome/desktop/wm/keybindings/move-to-workspace-1"
      value: "['<Shift><Super>exclam']"
    - key: "/org/gnome/desktop/wm/keybindings/move-to-workspace-2"
      value: "['<Shift><Super>at']"
    - key: "/org/gnome/desktop/wm/keybindings/move-to-workspace-3"
      value: "['<Shift><Super>numbersign']"
    - key: "/org/gnome/desktop/wm/keybindings/move-to-workspace-4"
      value: "['<Shift><Super>dollar']"
    - key: "/org/gnome/desktop/wm/keybindings/move-to-workspace-down"
      value: "['<Shift><Super>Down']"
    - key: "/org/gnome/desktop/wm/keybindings/move-to-workspace-up"
      value: "['<Shift><Super>Up']"
    - key: "/org/gnome/desktop/wm/keybindings/show-desktop"
      value: "['<Super>d']"
    - key: "/org/gnome/desktop/wm/keybindings/switch-applications-backward"
      value: "@as []"
    - key: "/org/gnome/desktop/wm/keybindings/switch-applications"
      value: "@as []"
    - key: "/org/gnome/desktop/wm/keybindings/switch-input-source-backward"
      value: "@as []"
    - key: "/org/gnome/desktop/wm/keybindings/switch-input-source"
      value: "@as []"
    - key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-1"
      value: "['<Super>1']"
    - key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-2"
      value: "['<Super>2']"
    - key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-3"
      value: "['<Super>3']"
    - key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-4"
      value: "['<Super>4']"
    - key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-down"
      value: "['<Super>Down']"
    - key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-up"
      value: "['<Super>Up']"
    - key: "/org/gnome/desktop/wm/keybindings/switch-windows-backward"
      value: "['<Shift><Alt>Tab']"
    - key: "/org/gnome/desktop/wm/keybindings/switch-windows"
      value: "['<Alt>Tab']"
    - key: "/org/gnome/desktop/wm/keybindings/unmaximize"
      value: "['<Primary><Super>Down']"
    - key: "/org/gnome/desktop/wm/preferences/button-layout"
      value: "'close,minimize,maximize:appmenu'"
    - key: "/org/gnome/desktop/wm/preferences/titlebar-font"
      value: "'Ubuntu Bold 11'"
    - key: "/org/gnome/mutter/edge-tiling"
      value: "true"
    - key: "/org/gnome/mutter/keybindings/toggle-tiled-left"
      value: "['<Primary><Super>Left']"
    - key: "/org/gnome/mutter/keybindings/toggle-tiled-right"
      value: "['<Primary><Super>Right']"
    - key: "/org/gnome/nautilus/preferences/click-policy"
      value: "'single'"
    - key: "/org/gnome/pomodoro/preferences/enabled-plugins"
      value: "['sounds']"
    - key: "/org/gnome/pomodoro/preferences/pause-when-idle"
      value: "true"
    - key: "/org/gnome/settings-daemon/plugins/media-keys/terminal"
      value: "['<Super>t']"
    - key: "/org/gnome/settings-daemon/plugins/xsettings/antialiasing"
      value: "'rgba'"
    - key: "/org/gnome/shell/enabled-extensions"
      value: "['ubuntu-appindicators@ubuntu.com', 'user-theme@gnome-shell-extensions.gcampax.github.com', 'dash-to-dock@micxgx.gmail.com', 'remove-rounded-corners@markbokil.com', 'Shortcuts@kyle.aims.ac.za', 'switcher@landau.fi', 'transparent-top-bar@zhanghai.me', 'windowIsReady_Remover@nunofarruca@gmail.com', 'pomodoro@arun.codito.in', 'drawOnYourScreen@abakkk.framagit.org']"
    - key: "/org/gnome/shell/extensions/dash-to-dock/background-opacity"
      value: "0.5"
    - key: "/org/gnome/shell/extensions/dash-to-dock/custom-theme-shrink"
      value: "true"
    - key: "/org/gnome/shell/extensions/dash-to-dock/dock-position"
      value: "'BOTTOM'"
    - key: "/org/gnome/shell/extensions/dash-to-dock/force-straight-corner"
      value: "true"
    - key: "/org/gnome/shell/extensions/dash-to-dock/hot-keys"
      value: "false"
    - key: "/org/gnome/shell/extensions/dash-to-dock/intellihide-mode"
      value: "'FOCUS_APPLICATION_WINDOWS'"
    - key: "/org/gnome/shell/extensions/dash-to-dock/require-pressure-to-show"
      value: "false"
    - key: "/org/gnome/shell/extensions/dash-to-dock/show-apps-at-top"
      value: "true"
    - key: "/org/gnome/shell/extensions/dash-to-dock/show-delay"
      value: "0.0"
    - key: "/org/gnome/shell/extensions/dash-to-dock/show-mounts"
      value: "false"
    - key: "/org/gnome/shell/extensions/dash-to-dock/show-show-apps-button"
      value: "true"
    - key: "/org/gnome/shell/extensions/dash-to-dock/show-trash"
      value: "false"
    - key: "/org/gnome/shell/extensions/dash-to-dock/transparency-mode"
      value: "'FIXED'"
    - key: "/org/gnome/shell/extensions/shortcuts/shortcuts-file"
      value: "'/home/markus/.shortcuts.json'"
    - key: "/org/gnome/shell/extensions/shortcuts/show-icon"
      value: "false"
    - key: "/org/gnome/shell/extensions/shortcuts/use-custom-shortcuts"
      value: "true"
    - key: "/org/gnome/shell/extensions/switcher/fade-enable"
      value: "false"
    - key: "/org/gnome/shell/extensions/switcher/font-size"
      value: "uint32 18"
    - key: "/org/gnome/shell/extensions/switcher/matching"
      value: "uint32 1"
    - key: "/org/gnome/shell/extensions/switcher/never-show-onboarding"
      value: "true"
    - key: "/org/gnome/shell/extensions/switcher/onboarding-1"
      value: "uint32 1"
    - key: "/org/gnome/shell/extensions/switcher/show-launcher"
      value: "['<Super>space']"
    - key: "/org/gnome/shell/keybindings/focus-active-notification"
      value: "@as []"
    - key: "/org/gnome/shell/keybindings/toggle-message-tray"
      value: "['<Super>n']"
    - key: "/org/gnome/terminal/legacy/profiles:/:b1dcc9dd-5262-4d8d-a863-c897e6d979b9/audible-bell"
      value: "false"
    - key: "/org/gnome/terminal/legacy/profiles:/:b1dcc9dd-5262-4d8d-a863-c897e6d979b9/background-color"
      value: "'rgb(0,43,54)'"
    - key: "/org/gnome/terminal/legacy/profiles:/:b1dcc9dd-5262-4d8d-a863-c897e6d979b9/background-transparency-percent"
      value: "10"
    - key: "/org/gnome/terminal/legacy/profiles:/:b1dcc9dd-5262-4d8d-a863-c897e6d979b9/custom-command"
      value: "'tmux'"
    - key: "/org/gnome/terminal/legacy/profiles:/:b1dcc9dd-5262-4d8d-a863-c897e6d979b9/font"
      value: "'DejaVu Sans Mono 11'"
    - key: "/org/gnome/terminal/legacy/profiles:/:b1dcc9dd-5262-4d8d-a863-c897e6d979b9/foreground-color"
      value: "'rgb(131,148,150)'"
    - key: "/org/gnome/terminal/legacy/profiles:/:b1dcc9dd-5262-4d8d-a863-c897e6d979b9/palette"
      value: "['rgb(7,54,66)', 'rgb(220,50,47)', 'rgb(133,153,0)', 'rgb(181,137,0)', 'rgb(38,139,210)', 'rgb(211,54,130)', 'rgb(42,161,152)', 'rgb(238,232,213)', 'rgb(0,43,54)', 'rgb(203,75,22)', 'rgb(88,110,117)', 'rgb(101,123,131)', 'rgb(131,148,150)', 'rgb(108,113,196)', 'rgb(147,161,161)', 'rgb(253,246,227)']"
    - key: "/org/gnome/terminal/legacy/profiles:/:b1dcc9dd-5262-4d8d-a863-c897e6d979b9/use-custom-command"
      value: "true"
    - key: "/org/gnome/terminal/legacy/profiles:/:b1dcc9dd-5262-4d8d-a863-c897e6d979b9/use-system-font"
      value: "false"
    - key: "/org/gnome/terminal/legacy/profiles:/:b1dcc9dd-5262-4d8d-a863-c897e6d979b9/use-theme-colors"
      value: "false"
    - key: "/org/gnome/terminal/legacy/profiles:/:b1dcc9dd-5262-4d8d-a863-c897e6d979b9/use-theme-transparency"
      value: "false"
    - key: "/org/gnome/terminal/legacy/profiles:/:b1dcc9dd-5262-4d8d-a863-c897e6d979b9/use-transparent-background"
      value: "true"
